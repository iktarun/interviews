Publisher/Subsciber model implementation

different approach, pull/push based appraoch